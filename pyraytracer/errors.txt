Scatter # 1, # of rays 10
# of times each surface is hit:
Bot Cyl: 0
Top Cyl: 4
Top Cap: 1
Mid Interface: 5
Bot Cap: 0
Points of intersection:
[[ 8.55227729 -5.18252382  8.47267092]
 [ 4.81670765 -8.76352255  7.67982242]
 [-0.95736427 -4.37227297  5.        ]
 [ 3.81123575  0.76566811  5.        ]
 [ 0.23648639 -1.5290716   5.        ]
 [-0.90069369 -1.33358035  5.        ]
 [ 1.31951559 -1.05586106  5.        ]
 [ 4.34403934  9.0071817   8.0169586 ]
 [ 2.21972922  0.7390879  10.        ]
 [-9.59134393  2.82950908  6.59556095]]
Total intensity absorbed by each surface:
Bot Cyl: [0. 0.]
Top Cyl: [ 0.00000000e+00 -1.11022302e-15]
Top Cap: [0. 1.]
Mid Interface: [-6.66133815e-16  0.00000000e+00]
Bot Cap: [0. 0.]
Rays escaping geometry: [[0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]]


Scatter # 2, # of rays 6
# of times each surface is hit:
Bot Cyl: 0
Top Cyl: 2
Top Cap: 4
Mid Interface: 0
Bot Cap: 0
Points of intersection:
[[-0.31741768  0.19234931 10.        ]
 [-4.81670765  8.76352255  9.03946726]
 [ 0.82770238 -5.35175059 10.        ]
 [-3.15242793 -4.66753124 10.        ]
 [ 4.61830457 -3.6955137  10.        ]
 [ 9.59134393 -2.82950908  5.78668284]]
Total intensity absorbed by each surface:
Bot Cyl: [0. 0.]
Top Cyl: [ 0.00000000e+00 -2.22044605e-16]
Top Cap: [0. 4.]
Mid Interface: [0. 0.]
Bot Cap: [0. 0.]
Rays escaping geometry: [[0. 0.]
 [1. 0.]
 [0. 0.]
 [0. 2.]
 [0. 0.]]


incoming: [[ 0.84610198 -0.51272235  0.14569567]
 [ 0.48056157 -0.87433418  0.06782569]
 [-0.19528566 -0.89186764 -0.40796522]
 [ 0.87179708  0.17514194 -0.45748788]
 [ 0.09352341 -0.60470281 -0.79094114]
 [-0.35086882 -0.51950154 -0.77910797]
 [ 0.50394166 -0.40324827 -0.76382828]
 [ 0.4321749   0.89609635  0.10117403]
 [ 0.58346389  0.19427194  0.7885609 ]
 [-0.95835092  0.28271978 -0.04041087]]
reflected: [[-0.84610198  0.51272235  0.14569567]
 [-0.48056157  0.87433418  0.06782569]
 [-0.19528566 -0.89186764  0.40796522]
 [ 0.87179708  0.17514194  0.45748788]
 [ 0.09352341 -0.60470281  0.79094114]
 [-0.35086882 -0.51950154  0.77910797]
 [ 0.50394166 -0.40324827  0.76382828]
 [-0.4321749  -0.89609635  0.10117403]
 [ 0.58346389  0.19427194 -0.7885609 ]
 [ 0.95835092 -0.28271978 -0.04041087]]
refracted: [[ 8.55227729e-01 -5.18252382e-01  2.91391343e-07]
 [ 4.81670765e-01 -8.76352255e-01  1.35651383e-07]
 [-2.13895074e-01 -9.76856641e-01  0.00000000e+00]
 [ 9.80411077e-01  1.96962232e-01 -0.00000000e+00]
 [ 1.24697878e-01 -8.06270417e-01 -5.78254661e-01]
 [-4.67825088e-01 -6.92668719e-01 -5.48953306e-01]
 [ 6.71922214e-01 -5.37664355e-01 -5.09350154e-01]
 [ 4.34403934e-01  9.00718170e-01  2.02348065e-07]
 [ 1.16692779e-06  3.88543880e-07  1.00000000e+00]
 [-9.59134393e-01  2.82950908e-01 -8.08217375e-08]]
total amp: [1. 1. 1. 1. 1. 1. 1. 1. 0. 1.]
amp rescale: [1.00000795 1.         1.09907352 2.24978654 1.00000715 1.00000805
 1.         1.00056902        nan 1.00000908]
amp rescale cut: [1.00000795 1.         1.09907352 2.24978654 1.00000715 1.00000805
 1.         1.00056902 0.         1.00000908]
dice roll: [[-8.46101983e-01  5.12722347e-01  1.45695672e-01  5.18252382e-01
   8.55227729e-01  0.00000000e+00  1.00000000e+00  3.34709238e-08
   0.00000000e+00  0.00000000e+00]
 [-4.80561567e-01  8.74334179e-01  6.78256915e-02  8.76352255e-01
   4.81670765e-01  8.18438412e-16  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-2.13895074e-01 -9.76856641e-01  0.00000000e+00  9.76856641e-01
  -2.13895074e-01  0.00000000e+00  1.00000000e+00  5.54151045e-03
   0.00000000e+00  0.00000000e+00]
 [ 9.80411077e-01  1.96962232e-01 -0.00000000e+00 -1.96962232e-01
   9.80411077e-01  0.00000000e+00  1.00000000e+00  9.99982094e-01
   0.00000000e+00  0.00000000e+00]
 [ 9.35234085e-02 -6.04702813e-01  7.90941136e-01  9.88250493e-01
   1.52842938e-01 -0.00000000e+00  1.00000000e+00  8.42488975e-07
   0.00000000e+00  0.00000000e+00]
 [-3.50868816e-01 -5.19501539e-01  7.79107967e-01  8.28696797e-01
  -5.59697792e-01  0.00000000e+00  1.00000000e+00 -3.39100173e-08
   0.00000000e+00  0.00000000e+00]
 [ 5.03941661e-01 -4.03248266e-01  7.63828278e-01  6.24784735e-01
   7.80797051e-01 -0.00000000e+00  1.00000000e+00 -1.11022302e-16
   0.00000000e+00  0.00000000e+00]
 [ 4.34403934e-01  9.00718170e-01  2.02348065e-07 -9.00718170e-01
   4.34403934e-01  0.00000000e+00  1.00000000e+00  4.06034284e-04
   0.00000000e+00  0.00000000e+00]
 [ 1.16692779e-06  3.88543880e-07  1.00000000e+00  3.15911593e-01
  -9.48788631e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 9.58350921e-01 -2.82719779e-01 -4.04108687e-02  2.82950908e-01
   9.59134393e-01 -1.37366884e-15  1.00000000e+00 -1.06926139e-06
   0.00000000e+00  0.00000000e+00]]
surface abs: [-2.22044605e-16 -4.44089210e-16  0.00000000e+00 -2.22044605e-16
  0.00000000e+00 -2.22044605e-16 -2.22044605e-16 -2.22044605e-16
  1.00000000e+00 -2.22044605e-16]


not scatter cut: [False False False False False False False False False False]
outfrom cut: [False False False False False False False False False False]
infrom cut: [False False False False False False False False False False]


not scatter cut: [False False False False False False False False False False]
outfrom cut: [ True  True  True  True  True  True  True  True  True  True]
infrom cut: [False False False False False False False False False False]


not scatter cut: [False False False False False False False False False False]
outfrom cut: [False False False False False False False False False False]
infrom cut: [False False False False False False False False False False]


not scatter cut: [False False False False False False False False False False]
outfrom cut: [False False False False False False False False False False]
infrom cut: [False False False False False False False False False False]


not scatter cut: [False False False False False False False False False False]
outfrom cut: [False False False False False False False False False False]
infrom cut: [False False False False False False False False False False]


incoming: [[-0.84610198  0.51272235  0.14569567]
 [-0.48056157  0.87433418  0.06782569]
 [ 0.09352341 -0.60470281  0.79094114]
 [-0.35086882 -0.51950154  0.77910797]
 [ 0.50394166 -0.40324827  0.76382828]
 [ 0.95835092 -0.28271978 -0.04041087]]
reflected: [[-0.84610198  0.51272235 -0.14569567]
 [ 0.48056157 -0.87433418  0.06782569]
 [ 0.09352341 -0.60470281 -0.79094114]
 [-0.35086882 -0.51950154 -0.77910797]
 [ 0.50394166 -0.40324827 -0.76382828]
 [-0.95835092  0.28271978 -0.04041087]]
refracted: [[-1.69220397e-06  1.02544469e-06  1.00000000e+00]
 [-4.81670765e-01  8.76352255e-01  1.35651383e-07]
 [ 1.87046817e-07 -1.20940563e-06  1.00000000e+00]
 [-7.01737632e-07 -1.03900308e-06  1.00000000e+00]
 [ 1.00788332e-06 -8.06496533e-07  1.00000000e+00]
 [ 9.59134393e-01 -2.82950908e-01 -8.08217375e-08]]
total amp: [0. 1. 0. 0. 0. 0. 0. 0. 1.]
amp rescale: [       nan 1.00000628        nan        nan        nan        nan
        nan        nan 1.00000924]
amp rescale cut: [0.         1.00000628 0.         0.         0.         0.
 0.         0.         1.00000924]
dice roll: [[-1.69220397e-06  1.02544469e-06  1.00000000e+00  5.18252382e-01
   8.55227729e-01 -0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 4.80561567e-01 -8.74334179e-01  6.78256915e-02 -8.76352255e-01
  -4.81670765e-01  8.18438412e-16  1.00000000e+00 -4.73326735e-08
   0.00000000e+00  0.00000000e+00]
 [-2.13895074e-01 -9.76856641e-01  0.00000000e+00  9.76856641e-01
  -2.13895074e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 9.80411077e-01  1.96962232e-01 -0.00000000e+00 -1.96962232e-01
   9.80411077e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 1.87046817e-07 -1.20940563e-06  1.00000000e+00 -9.88250493e-01
  -1.52842938e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-7.01737632e-07 -1.03900308e-06  1.00000000e+00 -8.28696797e-01
   5.59697792e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 1.00788332e-06 -8.06496533e-07  1.00000000e+00 -6.24784735e-01
  -7.80797051e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 4.34403934e-01  9.00718170e-01  2.02348065e-07 -9.00718170e-01
   4.34403934e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-9.58350921e-01  2.82719779e-01 -4.04108687e-02 -2.82950908e-01
  -9.59134393e-01 -2.74733768e-15  1.00000000e+00 -2.30277046e-06
   0.00000000e+00  0.00000000e+00]]
surface abs: [ 1.00000000e+00 -2.22044605e-16  1.00000000e+00  1.00000000e+00
  1.00000000e+00  1.00000000e+00  1.00000000e+00  1.00000000e+00
  0.00000000e+00]


not scatter cut: [False False  True  True False False False  True False]
outfrom cut: [False False False False False False False False False]
infrom cut: [False False False False False False False False False]


not scatter cut: [False False  True  True False False False  True False]
outfrom cut: [ True  True False False False False False  True  True]
infrom cut: [False False False False False False False False False]


not scatter cut: [False False  True  True False False False  True False]
outfrom cut: [False False False False False False False False False]
infrom cut: [False False False False False False False False False]


not scatter cut: [False False  True  True False False False  True False]
outfrom cut: [False False False False False False False False False]
infrom cut: [False False  True  True  True  True  True False False]


not scatter cut: [False False  True  True False False False  True False]
outfrom cut: [False False False False False False False False False]
infrom cut: [False False False False False False False False False]


-----------------------------


incoming: [[-0.18625578 -0.94037012  0.28462751]
 [-0.62228051 -0.01492375 -0.78265206]]
reflected: [[ 0.18625578  0.94037012  0.28462751]
 [-0.62228051 -0.01492375  0.78265206]][0.54599042 0.50031988]
refracted: [[-1.94292050e-01 -9.80943729e-01  5.69255030e-07] #####
 [-8.29707353e-01 -1.98983331e-02 -5.57843854e-01]][0.45400958 0.49968012]
total amp: [1. 1.]
amp rescale: [2.20259667 1.99872129]
amp rescale cut: [2.20259667 1.99872129]
total amp after: [1. 1.]
dice roll: [[-1.94292050e-01 -9.80943729e-01  5.69255030e-07  9.80943729e-01
  -1.94292050e-01  0.00000000e+00  1.00000000e+00 -9.99983108e-01
   0.00000000e+00  0.00000000e+00]			########
 [-6.22280514e-01 -1.49237498e-02  7.82652057e-01  2.39754574e-02
  -9.99712547e-01  0.00000000e+00  1.00000000e+00  9.98704606e-01
   0.00000000e+00  0.00000000e+00]]
surface abs: [ 0.00000000e+00 -2.22044605e-16]

Scatter # 1, # of rays 2
# of times each surface is hit:
Bot Cyl: 0
Top Cyl: 1
Top Cap: 0
Mid Interface: 1
Bot Cap: 0
Points of intersection:
[[-1.9429205  -9.80943729  9.96908175]
 [-1.59018432 -0.03813636  5.        ]]
Total intensity absorbed by each surface:
Bot Cyl: [0. 0.]
Top Cyl: [0. 0.]
Top Cap: [0. 0.]
Mid Interface: [-2.22044605e-16  0.00000000e+00]
Bot Cap: [0. 0.]
Rays escaping geometry: [[0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]]


------------------------------


scatter here: [False False]
incoming: [[ 0.3004003   0.46835951 -0.83090254]
 [-0.65386403 -0.70804726 -0.26670376]]
reflected: [[ 0.3004003   0.46835951  0.83090254]
 [-0.65386403 -0.70804726  0.26670376]][0.53023933 0.50066963]
refracted: [[ 0.40053373  0.62447934 -0.6705209 ]
 [-0.67843804 -0.73465762  0.        ]][0.46976067 0.49933037]
total amp: [1. 1.]
amp rescale: [1.88594084 2.00268211]
amp rescale cut: [1.88594084 2.00268211]
total amp after: [1. 1.]
dice roll: [[ 0.3004003   0.46835951  0.83090254 -0.84174043  0.53988244  0.
   1.         -0.88594084  0.          0.        ]
 [-0.67843804 -0.73465762  0.          0.73465762 -0.67843804  0.
   1.          1.          0.          0.        ]]
surface abs: [-2.22044605e-16  0.00000000e+00]

Scatter # 1, # of rays 2
# of times each surface is hit:
Bot Cyl: 0
Top Cyl: 0
Top Cap: 0
Mid Interface: 2
Bot Cap: 0
Points of intersection:
[[ 0.72306988  1.12735125  5.        ]
 [-4.90329823 -5.30961594  5.        ]]
Total intensity absorbed by each surface:
Bot Cyl: [0. 0.]
Top Cyl: [0. 0.]
Top Cap: [0. 0.]
Mid Interface: [-2.22044605e-16  0.00000000e+00]
Bot Cap: [0. 0.]
Rays escaping geometry: [[0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]]

--------------------

n1: [2. 2. 2. 2. 2. 2. 2.]
n2: [inf inf inf inf inf inf 1.5]
sin: [0.         0.         0.         0.         0.         0.
 1.31781011]
cos: [1.+0.j         1.+0.j         1.+0.j         1.+0.j
 1.+0.j         1.+0.j         0.+0.85826772j]
rs bef: [        nan       +nanj         nan       +nanj         nan       +nanj
         nan       +nanj         nan       +nanj         nan       +nanj
 -0.89417467-0.44771827j]
rp bef: [        nan       +nanj         nan       +nanj         nan       +nanj
         nan       +nanj         nan       +nanj         nan       +nanj
 -0.96525962-0.26129268j]
rs: [-1.        +0.j         -1.        +0.j         -1.        +0.j
 -1.        +0.j         -1.        +0.j         -1.        +0.j
 -0.89417467-0.44771827j]
rp: [ 1.        +0.j          1.        +0.j          1.        +0.j
  1.        +0.j          1.        +0.j          1.        +0.j
 -0.96525962-0.26129268j]
ts: [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 1.05367121e-08]
tp: [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 1.49011612e-08]
incoming: [[-0.3209154   0.71007043  0.62674819]
 [-0.40949585  0.91231198 -0.        ]
 [ 0.12501936 -0.29865757  0.94613625]
 [-0.04131289 -0.44735536  0.8934016 ]
 [ 0.91148767  0.02944416  0.41027219]
 [-0.9259653   0.37600256 -0.03478993]
 [-0.89939509  0.40980384 -0.15214891]][1. 1. 1. 1. 1. 1. 1.]
reflected: [[-0.3209154   0.71007043 -0.62674819]
 [ 0.40949585 -0.91231198  0.        ]
 [ 0.12501936 -0.29865757 -0.94613625]
 [-0.04131289 -0.44735536 -0.8934016 ]
 [-0.91148767 -0.02944416 -0.41027219]
 [ 0.89132232 -0.45203338 -0.03478993]
 [-0.89939509  0.40980384  0.15214891]][1. 0. 1. 1. 0. 1. 1.]
refracted: [[ 0.          0.          1.        ]
 [-0.40949585  0.91231198 -0.        ]
 [ 0.          0.          1.        ]
 [ 0.          0.          1.        ]
 [ 0.91148767  0.02944416  0.41027219]
 [-0.90998956  0.41463115 -0.        ]
 [-0.90998956  0.41463115 -0.        ]][0.00000000e+00 1.00000000e+00 0.00000000e+00 5.55111512e-17
 1.00000000e+00 0.00000000e+00 1.11022302e-16]


dice roll: [[ 0.00000000e+00  0.00000000e+00  1.00000000e+00  9.11255787e-01
   4.11840855e-01 -0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-4.09495846e-01  9.12311982e-01 -0.00000000e+00 -0.00000000e+00
  -0.00000000e+00  1.00000000e+00  1.00000000e+00 -5.59208148e-03
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -9.22441081e-01
  -3.86137867e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -9.95762899e-01
   9.19578608e-02  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 9.11487670e-01  2.94441573e-02  4.10272189e-01 -2.79322835e-01
  -6.87876311e-01  6.69929052e-01  1.00000000e+00  0.00000000e+00
  -0.00000000e+00  0.00000000e+00]
 [ 8.91322324e-01 -4.52033380e-01 -3.47899316e-02  2.65336341e-01
   5.82332754e-01 -7.68430342e-01  1.00000000e+00 -0.00000000e+00
   1.09159807e-16  0.00000000e+00]
 [-8.99395085e-01  4.09803844e-01  1.52148907e-01 -4.14631153e-01
  -9.09989564e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]]

Scatter # 2, # of rays 7
# of times each surface is hit:
Bot Cyl: 0
Top Cyl: 3
Top Cap: 3
Mid Interface: 1
Bot Cap: 0
Points of intersection:
[[-3.58422701  7.93060611 10.        ]
 [ 3.86137867 -9.22441081 32.22259574] ####
 [ 0.92495721 -2.20962149 10.        ]
 [-0.32369566 -3.50512863 10.        ]
 [-9.26526175  3.76230311  5.95566986]
 [-9.09989564  4.14631153  2.38176537]
 [ 6.37722741 -2.90574448  5.        ]]
Total intensity absorbed by each surface:
Bot Cyl: [0. 0.]
Top Cyl: [0.00000000e+00 1.11022302e-16]
Top Cap: [0. 3.]
Mid Interface: [-2.22044605e-16  0.00000000e+00]
Bot Cap: [0. 0.]
Rays escaping geometry: [[0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]]

--------

Scatter # 1, # of rays 10
# of times each surface is hit:
Bot Cyl: 0
Top Cyl: 2
Top Cap: 3
Mid Interface: 5
Bot Cap: 0
Points of intersection:
[[ 2.06056703  0.06658744 10.        ]
 [-6.09372698 -7.92883923  5.81784845]
 [-2.40272127 -4.01668604  5.        ]
 [-2.24630368 -1.87875159 10.        ]
 [-0.263154   -0.44642922  5.        ]
 [ 0.70087666 -1.41437996  5.        ]
 [ 1.99099317  0.42828803  5.        ]
 [-0.19444485  0.12660009  5.        ]
 [ 7.78336959  6.27846779  8.7289263 ]
 [-0.17281515  2.29193878 10.        ]]
Total intensity absorbed by each surface:
Bot Cyl: [0. 0.]
Top Cyl: [ 0.0000000e+00 -8.8817842e-16]
Top Cap: [0. 3.]
Mid Interface: [-8.8817842e-16  0.0000000e+00]
Bot Cap: [0. 0.]
Rays escaping geometry: [[0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]]

n1: [2. 2. 2. 2. 2. 2. 2. 2. 2. 2.]
n2: [inf inf 1.5 inf 1.5 1.5 1.5 1.5 inf inf]
sin: [0.         0.         1.22608725 0.         0.33443401 0.82605188
 0.95130406 0.15365389 0.         0.        ]
cos: [1.        +0.j         1.        +0.j         0.        +0.70942932j
 1.        +0.j         0.94241917+0.j         0.56359408+0.j
 0.3082541 +0.j         0.98812473+0.j         1.        +0.j
 1.        +0.j        ]
rs bef: [        nan       +nanj         nan       +nanj -0.29417417-0.95575183j
         nan       +nanj  0.15596528+0.j          0.29997676+0.j
  0.5038127 +0.j          0.14543332+0.j                 nan       +nanj
         nan       +nanj]
rp bef: [        nan       +nanj         nan       +nanj -0.70566401-0.70854661j
         nan       +nanj -0.1296987 +0.j          0.02180854-0.j
  0.26057079-0.j         -0.14027903+0.j                 nan       +nanj
         nan       +nanj]
rs: [-1.        +0.j         -1.        +0.j         -0.29417417-0.95575183j
 -1.        +0.j          0.15596528+0.j          0.29997676+0.j
  0.5038127 +0.j          0.14543332+0.j         -1.        +0.j
 -1.        +0.j        ]
rp: [ 1.        +0.j          1.        +0.j         -0.70566401-0.70854661j
  1.        +0.j         -0.1296987 +0.j          0.02180854-0.j
  0.26057079-0.j         -0.14027903+0.j          1.        +0.j
  1.        +0.j        ]
ts: [0.00000000e+00 0.00000000e+00 2.10734243e-08 0.00000000e+00
 9.87762538e-01 9.53946509e-01 8.63812920e-01 9.89368056e-01
 0.00000000e+00 0.00000000e+00]
tp: [0.         0.         0.         0.         0.99155345 0.99976217
 0.96545475 0.99011201 0.         0.        ]
incoming: [[ 0.56607339  0.01829272  0.82415187]
 [-0.60515887 -0.78740112 -0.1173977 ]
 [-0.47205891 -0.78915206 -0.39293689]
 [-0.53581336 -0.44814075  0.7155934 ]
 [-0.12737079 -0.21607896 -0.96803232]
 [ 0.27508216 -0.55512005 -0.78496594]
 [ 0.69752215  0.15004591 -0.70067759]
 [-0.09657469  0.06287832 -0.99333763]
 [ 0.76695846  0.61866829  0.17036511]
 [-0.04572718  0.60645084  0.79380502]][1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
reflected: [[ 0.56607339  0.01829272 -0.82415187]
 [ 0.60515887  0.78740112 -0.1173977 ]
 [-0.47205891 -0.78915206  0.39293689]
 [-0.53581336 -0.44814075 -0.7155934 ]
 [-0.12737079 -0.21607896  0.96803232]
 [ 0.27508216 -0.55512005  0.78496594]
 [ 0.69752215  0.15004591  0.70067759]
 [-0.09657469  0.06287832  0.99333763]
 [-0.76695846 -0.61866829  0.17036511]
 [-0.04572718  0.60645084 -0.79380502]][1.         1.         0.05715561 0.13748904 1.         1.
 1.         0.00864868 0.04378767 1.        ]
refracted: [[ 0.          0.          1.        ]
 [-0.6093727  -0.79288392 -0.        ] ### top
 [-0.51334999 -0.85817934  0.        ] mid
 [ 0.          0.          1.        ]
 [-0.16982772 -0.28810528 -0.94241917]
 [ 0.36677621 -0.74016007 -0.56359408]
 [ 0.93002953  0.20006122 -0.3082541 ]
 [-0.12876626  0.08383776 -0.98812473]
 [ 0.77833696  0.62784678  0.        ] top
 [ 0.          0.          1.        ]][0.00000000e+00 2.22044605e-16 9.42844387e-01 8.62510955e-01
 0.00000000e+00 0.00000000e+00 0.00000000e+00 9.91351318e-01
 9.56212330e-01 0.00000000e+00]

dice roll: [[ 0.00000000e+00  0.00000000e+00  1.00000000e+00  3.22982473e-02
  -9.99478276e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 6.05158875e-01  7.87401116e-01 -1.17397695e-01 -7.92883923e-01
   6.09372698e-01  0.00000000e+00  1.00000000e+00  2.22044605e-16
   0.00000000e+00  0.00000000e+00] top
 [-5.13349995e-01 -8.58179342e-01  0.00000000e+00  8.58179342e-01
  -5.13349995e-01  0.00000000e+00  1.00000000e+00  3.48206392e-02
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -6.41560199e-01
   7.67072690e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-1.27370790e-01 -2.16078957e-01  9.68032317e-01  8.61471234e-01
  -5.07806374e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 2.75082156e-01 -5.55120053e-01  7.84965945e-01  8.96021284e-01
   4.44011102e-01 -0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 6.97522146e-01  1.50045912e-01  7.00677587e-01 -2.10302073e-01
   9.77636455e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-1.28766259e-01  8.38377565e-02 -9.88124730e-01 -5.45627284e-01
  -8.38027963e-01  0.00000000e+00  1.00000000e+00 -8.24437267e-03
   0.00000000e+00  0.00000000e+00]
 [ 7.78336959e-01  6.27846779e-01  0.00000000e+00 -6.27846779e-01
   7.78336959e-01  0.00000000e+00  1.00000000e+00 -2.52135049e-02
   0.00000000e+00  0.00000000e+00] top
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00  9.97169386e-01
   7.51878640e-02 -0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]]

incident ray: [ 0.76695846  0.61866829  0.17036511] intensity: 1.
point of intersection: [ 7.78336959  6.27846779  8.7289263 ] (top cylinder)
refracted ray: [ 0.77833696  0.62784678  0.        ] intensity: 9.56212330e-01	#chosen by dice roll
reflected ray: [-0.76695846 -0.61866829  0.17036511] intensity: 0.04378767

----------------------------

Scatter # 1, # of rays 10
# of times each surface is hit:
Bot Cyl: 0
Top Cyl: 2
Top Cap: 6
Mid Interface: 2
Bot Cap: 0
Points of intersection:
[[ 5.77362178e+00  1.61632158e+00  1.00000000e+01]
 [-4.64009375e+00  8.85830288e+00  7.44493727e+00]
 [-3.91111219e+00 -2.34163473e+00  1.00000000e+01]
 [ 6.55978671e-01 -5.39218142e-01  5.00000000e+00]
 [ 9.24101763e+00 -3.03040370e+00  1.00000000e+01]
 [-6.30045956e-03 -7.30634188e+00  1.00000000e+01]
 [-9.13284970e+00 -4.07321204e+00  5.02368341e+00] ##
 [ 3.80235736e+00  2.40506104e-01  1.00000000e+01]
 [-8.94744341e-01 -3.26597958e+00  5.00000000e+00]
 [-1.64444854e+00  5.61555759e-01  1.00000000e+01]]
Total intensity absorbed by each surface:
Bot Cyl: [0. 0.]
Top Cyl: [ 0.0000000e+00 -4.4408921e-16]
Top Cap: [0. 6.]
Mid Interface: [-4.4408921e-16  0.0000000e+00]
Bot Cap: [0. 0.]
Rays escaping geometry: [[0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]
 [0. 0.]]

incoming: [[ 8.61186059e-01  2.41088464e-01  4.47476172e-01  2.69584683e-01
  -9.62976687e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-4.63550758e-01  8.84954753e-01  4.44497506e-02 -8.85830288e-01
  -4.64009375e-01  1.24885180e-15  1.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-7.16700239e-01 -4.29097937e-01  5.49741510e-01 -5.13683763e-01
   8.57979599e-01  0.00000000e+00  1.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 3.01904624e-01 -2.48167292e-01 -9.20470854e-01  6.35005552e-01
   7.72507572e-01 -0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 9.07992711e-01 -2.97757735e-01  2.94770364e-01 -3.11602834e-01
  -9.50212436e-01  0.00000000e+00  1.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-7.97701198e-04 -9.25055961e-01  3.79830006e-01 -9.99999628e-01
   8.62327183e-04  0.00000000e+00  1.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-8.95955332e-01 -3.99592259e-01 -1.93881586e-01 -4.07321204e-01
   9.13284970e-01  5.72629431e-16  1.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 7.84103474e-01  4.95959885e-02  6.18645278e-01  6.31256909e-02
  -9.98005585e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-2.27506207e-01 -8.30439033e-01 -5.08539023e-01  9.64461642e-01
  -2.64222900e-01  0.00000000e+00  1.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-4.74325067e-01  1.61975256e-01  8.65320604e-01  3.23162792e-01
   9.46343389e-01 -0.00000000e+00  1.00000000e+00  0.00000000e+00
  -0.00000000e+00  0.00000000e+00]]
reflected: [[ 8.61186059e-01  2.41088464e-01 -4.47476172e-01  2.69584683e-01
  -9.62976687e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 4.63550758e-01 -8.84954753e-01  4.44497506e-02 -8.85830288e-01
  -4.64009375e-01  1.24885180e-15  5.16134615e-01  4.83865385e-01
   0.00000000e+00  0.00000000e+00]
 [-7.16700239e-01 -4.29097937e-01 -5.49741510e-01 -5.13683763e-01
   8.57979599e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 3.01904624e-01 -2.48167292e-01  9.20470854e-01  6.35005552e-01
   7.72507572e-01 -0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 9.07992711e-01 -2.97757735e-01 -2.94770364e-01 -3.11602834e-01
  -9.50212436e-01  0.00000000e+00  1.00000000e+00 -1.66533454e-16
   0.00000000e+00  0.00000000e+00]
 [-7.97701198e-04 -9.25055961e-01 -3.79830006e-01 -9.99999628e-01
   8.62327183e-04  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 8.95955332e-01  3.99592259e-01 -1.93881586e-01 -4.07321204e-01
   9.13284970e-01  5.72629431e-16  5.05584034e-01  4.94415966e-01
   0.00000000e+00  0.00000000e+00]
 [ 7.84103474e-01  4.95959885e-02 -6.18645278e-01  6.31256909e-02
  -9.98005585e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-2.27506207e-01 -8.30439033e-01  5.08539023e-01  9.64461642e-01
  -2.64222900e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-4.74325067e-01  1.61975256e-01 -8.65320604e-01  3.23162792e-01
   9.46343389e-01 -0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]]
refracted: [[ 0.00000000e+00  0.00000000e+00  1.00000000e+00  2.69584683e-01
  -9.62976687e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-4.64009375e-01  8.85830288e-01  0.00000000e+00 -8.85830288e-01
  -4.64009375e-01  1.24885180e-15  4.83865385e-01 -4.83865385e-01
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -5.13683763e-01
   8.57979599e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 4.02539498e-01 -3.30889723e-01 -8.53506850e-01  6.35005552e-01
   7.72507572e-01 -0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -3.11602834e-01
  -9.50212436e-01  0.00000000e+00  5.55111512e-17  5.55111512e-17
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -9.99999628e-01
   8.62327183e-04  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-9.13284970e-01 -4.07321204e-01 -0.00000000e+00 -4.07321204e-01
   9.13284970e-01  5.72629431e-16  4.94415966e-01 -4.94415966e-01
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00  6.31256909e-02
  -9.98005585e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-2.64222900e-01 -9.64461642e-01  0.00000000e+00  9.64461642e-01
  -2.64222900e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00  3.23162792e-01
   9.46343389e-01 -0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]]
refracted check: [[ 0.          0.          1.        ]
 [-0.46400938  0.88583029  0.        ]
 [ 0.          0.          1.        ]
 [ 0.4025395  -0.33088972 -0.85350685]
 [ 0.          0.          1.        ]
 [ 0.          0.          1.        ]
 [-0.91328497 -0.4073212  -0.        ]
 [ 0.          0.          1.        ]
 [-0.2642229  -0.96446164  0.        ]
 [ 0.          0.          1.        ]][0.00000000e+00 4.83865385e-01 0.00000000e+00 0.00000000e+00
 5.55111512e-17 0.00000000e+00 4.94415966e-01 0.00000000e+00
 0.00000000e+00 0.00000000e+00]


dice roll: [[ 0.00000000e+00  0.00000000e+00  1.00000000e+00  2.69584683e-01
  -9.62976687e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 4.63550758e-01 -8.84954753e-01  4.44497506e-02 -8.85830288e-01
  -4.64009375e-01  1.24885180e-15  1.00000000e+00  9.37479043e-01
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -5.13683763e-01
   8.57979599e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 3.01904624e-01 -2.48167292e-01  9.20470854e-01  6.35005552e-01
   7.72507572e-01 -0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -3.11602834e-01
  -9.50212436e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00 -9.99999628e-01
   8.62327183e-04  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-9.13284970e-01 -4.07321204e-01 -0.00000000e+00 -4.07321204e-01
   9.13284970e-01  5.72629431e-16  1.00000000e+00 -1.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00  6.31256909e-02
  -9.98005585e-01  0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [-2.27506207e-01 -8.30439033e-01  5.08539023e-01  9.64461642e-01
  -2.64222900e-01  0.00000000e+00  1.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  1.00000000e+00  3.23162792e-01
   9.46343389e-01 -0.00000000e+00  0.00000000e+00 -0.00000000e+00
   0.00000000e+00  0.00000000e+00]]